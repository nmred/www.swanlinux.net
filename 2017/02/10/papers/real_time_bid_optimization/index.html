<!DOCTYPE html>
<html style="display: none;" lang="zh">
    <head>
    <meta charset="utf-8">
    <!--
        © Material Theme
        https://github.com/viosey/hexo-theme-material
        Version: 1.5.0 -->
    <script>
        window.materialVersion = "1.5.0"
        // Delete localstorage with these tags
        window.oldVersion = [
            'codestartv1',
            '1.3.4',
            '1.4.0',
            '1.4.0b1'
        ]
    </script>

    <!-- dns prefetch -->
    <meta http-equiv="x-dns-prefetch-control" content="on">














    <!-- Title -->
    
    <title>
        
            RTB 广告优化 ---- 在线平滑投放实现 | 
        
        Iodsp
    </title>

    <!-- Meta & Info -->
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="format-detection" content="telephone=no"/>
    <meta name="theme-color" content="#0097A7">
    <meta name="author" content="Nmred">
    <meta name="description" itemprop="description" content="">
    <meta name="keywords" content=",平滑投放,RTB,广告优化">

    <!-- Import lsloader -->
    <script>(function(){window.lsloader={jsRunSequence:[],jsnamemap:{},cssnamemap:{}};lsloader.removeLS=function(key){try{localStorage.removeItem(key)}catch(e){}};lsloader.setLS=function(key,val){try{localStorage.setItem(key,val)}catch(e){}};lsloader.getLS=function(key){var val="";try{val=localStorage.getItem(key)}catch(e){val=""}return val};versionString="/*"+(window.materialVersion||"unknownVersion")+"*/";lsloader.clean=function(){try{var keys=[];for(var i=0;i<localStorage.length;i++){keys.push(localStorage.key(i))}keys.forEach(function(key){var data=lsloader.getLS(key);if(window.oldVersion){var remove=window.oldVersion.reduce(function(p,c){return p||data.indexOf("/*"+c+"*/")!==-1},false);if(remove){lsloader.removeLS(key)}}})}catch(e){}};lsloader.clean();lsloader.load=function(jsname,jspath,cssonload,isJs){if(typeof cssonload==="boolean"){isJs=cssonload;cssonload=undefined}isJs=isJs||false;cssonload=cssonload||function(){};var code;code=this.getLS(jsname);if(code&&code.indexOf(versionString)===-1){this.removeLS(jsname);this.requestResource(jsname,jspath,cssonload,isJs);return}if(code){var versionNumber=code.split(versionString)[0];if(versionNumber!=jspath){console.log("reload:"+jspath);this.removeLS(jsname);this.requestResource(jsname,jspath,cssonload,isJs);return}code=code.split(versionString)[1];if(isJs){this.jsRunSequence.push({name:jsname,code:code});this.runjs(jspath,jsname,code)}else{document.getElementById(jsname).appendChild(document.createTextNode(code));cssonload()}}else{this.requestResource(jsname,jspath,cssonload,isJs)}};lsloader.requestResource=function(name,path,cssonload,isJs){var that=this;if(isJs){this.iojs(path,name,function(path,name,code){that.setLS(name,path+versionString+code);that.runjs(path,name,code)})}else{this.iocss(path,name,function(code){document.getElementById(name).appendChild(document.createTextNode(code));that.setLS(name,path+versionString+code)},cssonload)}};lsloader.iojs=function(path,jsname,callback){var that=this;that.jsRunSequence.push({name:jsname,code:""});try{var xhr=new XMLHttpRequest;xhr.open("get",path,true);xhr.onreadystatechange=function(){if(xhr.readyState==4){if(xhr.status>=200&&xhr.status<300||xhr.status==304){if(xhr.response!=""){callback(path,jsname,xhr.response);return}}that.jsfallback(path,jsname)}};xhr.send(null)}catch(e){that.jsfallback(path,jsname)}};lsloader.iocss=function(path,jsname,callback,cssonload){var that=this;try{var xhr=new XMLHttpRequest;xhr.open("get",path,true);xhr.onreadystatechange=function(){if(xhr.readyState==4){if(xhr.status>=200&&xhr.status<300||xhr.status==304){if(xhr.response!=""){callback(xhr.response);cssonload();return}}that.cssfallback(path,jsname,cssonload)}};xhr.send(null)}catch(e){that.cssfallback(path,jsname,cssonload)}};lsloader.iofonts=function(path,jsname,callback,cssonload){var that=this;try{var xhr=new XMLHttpRequest;xhr.open("get",path,true);xhr.onreadystatechange=function(){if(xhr.readyState==4){if(xhr.status>=200&&xhr.status<300||xhr.status==304){if(xhr.response!=""){callback(xhr.response);cssonload();return}}that.cssfallback(path,jsname,cssonload)}};xhr.send(null)}catch(e){that.cssfallback(path,jsname,cssonload)}};lsloader.runjs=function(path,name,code){if(!!name&&!!code){for(var k in this.jsRunSequence){if(this.jsRunSequence[k].name==name){this.jsRunSequence[k].code=code}}}if(!!this.jsRunSequence[0]&&!!this.jsRunSequence[0].code&&this.jsRunSequence[0].status!="failed"){var script=document.createElement("script");script.appendChild(document.createTextNode(this.jsRunSequence[0].code));script.type="text/javascript";document.getElementsByTagName("head")[0].appendChild(script);this.jsRunSequence.shift();if(this.jsRunSequence.length>0){this.runjs()}}else if(!!this.jsRunSequence[0]&&this.jsRunSequence[0].status=="failed"){var that=this;var script=document.createElement("script");script.src=this.jsRunSequence[0].path;script.type="text/javascript";this.jsRunSequence[0].status="loading";script.onload=function(){that.jsRunSequence.shift();if(that.jsRunSequence.length>0){that.runjs()}};document.body.appendChild(script)}};lsloader.tagLoad=function(path,name){this.jsRunSequence.push({name:name,code:"",path:path,status:"failed"});this.runjs()};lsloader.jsfallback=function(path,name){if(!!this.jsnamemap[name]){return}else{this.jsnamemap[name]=name}for(var k in this.jsRunSequence){if(this.jsRunSequence[k].name==name){this.jsRunSequence[k].code="";this.jsRunSequence[k].status="failed";this.jsRunSequence[k].path=path}}this.runjs()};lsloader.cssfallback=function(path,name,cssonload){if(!!this.cssnamemap[name]){return}else{this.cssnamemap[name]=1}var link=document.createElement("link");link.type="text/css";link.href=path;link.rel="stylesheet";link.onload=link.onerror=cssonload;var root=document.getElementsByTagName("script")[0];root.parentNode.insertBefore(link,root)};lsloader.runInlineScript=function(scriptId,codeId){var code=document.getElementById(codeId).innerText;this.jsRunSequence.push({name:scriptId,code:code});this.runjs()};lsloader.loadCombo=function(jslist){var updateList="";var requestingModules={};for(var k in jslist){var LS=this.getLS(jslist[k].name);if(!!LS){var version=LS.split(versionString)[0];var code=LS.split(versionString)[1]}else{var version=""}if(version==jslist[k].path){this.jsRunSequence.push({name:jslist[k].name,code:code,path:jslist[k].path})}else{this.jsRunSequence.push({name:jslist[k].name,code:null,path:jslist[k].path,status:"comboloading"});requestingModules[jslist[k].name]=true;updateList+=(updateList==""?"":";")+jslist[k].path}}var that=this;if(!!updateList){var xhr=new XMLHttpRequest;xhr.open("get",combo+updateList,true);xhr.onreadystatechange=function(){if(xhr.readyState==4){if(xhr.status>=200&&xhr.status<300||xhr.status==304){if(xhr.response!=""){that.runCombo(xhr.response,requestingModules);return}}else{for(var i in that.jsRunSequence){if(requestingModules[that.jsRunSequence[i].name]){that.jsRunSequence[i].status="failed"}}that.runjs()}}};xhr.send(null)}this.runjs()};lsloader.runCombo=function(comboCode,requestingModules){comboCode=comboCode.split("/*combojs*/");comboCode.shift();for(var k in this.jsRunSequence){if(!!requestingModules[this.jsRunSequence[k].name]&&!!comboCode[0]){this.jsRunSequence[k].status="comboJS";this.jsRunSequence[k].code=comboCode[0];this.setLS(this.jsRunSequence[k].name,this.jsRunSequence[k].path+versionString+comboCode[0]);comboCode.shift()}}this.runjs()}})();</script>

    <!-- Import queue -->
    <script>function Queue(){this.dataStore=[];this.offer=b;this.poll=d;this.execNext=a;this.debug=false;this.startDebug=c;function b(e){if(this.debug){console.log("Offered a Queued Function.")}if(typeof e==="function"){this.dataStore.push(e)}else{console.log("You must offer a function.")}}function d(){if(this.debug){console.log("Polled a Queued Function.")}return this.dataStore.shift()}function a(){var e=this.poll();if(e!==undefined){if(this.debug){console.log("Run a Queued Function.")}e()}}function c(){this.debug=true}}var queue=new Queue();</script>

    <!-- Favicons -->
    <link rel="icon shortcut" type="image/ico" href="/img/iodsp.png">
    <link rel="icon" sizes="192x192" href="/img/iodsp.png">
    <link rel="apple-touch-icon" href="/img/iodsp.png">

    <!--iOS -->
    <meta name="apple-mobile-web-app-title" content="Title">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="480">

    <!-- Add to homescreen for Chrome on Android -->
    <meta name="mobile-web-app-capable" content="yes">

    <!-- Add to homescreen for Safari on iOS -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-title" content="Iodsp">

    <!-- Site Verification -->
    
    

    <!-- RSS -->
    

    <!--[if lte IE 9]>
        <link rel="stylesheet" href="/css/ie-blocker.css">

        
            <script src="/js/ie-blocker.zhCN.js"></script>
        
    <![endif]-->

    <!-- Import CSS -->
    
        <style id="material_css"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("material_css","/css/material.min.css?Z7a72R1E4SxzBKR/WGctOA==",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";}, false)</script>
        <style id="style_css"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("style_css","/css/style.min.css?MKetZV3cUTfDxvMffaOezg==",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";}, false)</script>

        

    

    

    <!-- Config CSS -->

<!-- Other Styles -->
<style>
  body, html {
    font-family: Roboto, "Helvetica Neue", Helvetica, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", "微软雅黑", Arial, sans-serif;
    overflow-x: hidden !important;
  }
  
  code {
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  }

  a {
    color: #00838F;
  }

  .mdl-card__media,
  #search-label,
  #search-form-label:after,
  #scheme-Paradox .hot_tags-count,
  #scheme-Paradox .sidebar_archives-count,
  #scheme-Paradox .sidebar-colored .sidebar-header,
  #scheme-Paradox .sidebar-colored .sidebar-badge{
    background-color: #0097A7 !important;
  }

  /* Sidebar User Drop Down Menu Text Color */
  #scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:hover,
  #scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:focus {
    color: #0097A7 !important;
  }

  #post_entry-right-info,
  .sidebar-colored .sidebar-nav li:hover > a,
  .sidebar-colored .sidebar-nav li:hover > a i,
  .sidebar-colored .sidebar-nav li > a:hover,
  .sidebar-colored .sidebar-nav li > a:hover i,
  .sidebar-colored .sidebar-nav li > a:focus i,
  .sidebar-colored .sidebar-nav > .open > a,
  .sidebar-colored .sidebar-nav > .open > a:hover,
  .sidebar-colored .sidebar-nav > .open > a:focus,
  #ds-reset #ds-ctx .ds-ctx-entry .ds-ctx-head a {
    color: #0097A7 !important;
  }

  .toTop {
    background: #757575 !important;
  }

  .material-layout .material-post>.material-nav,
  .material-layout .material-index>.material-nav,
  .material-nav a {
    color: #757575;
  }

  #scheme-Paradox .MD-burger-layer {
    background-color: #757575;
  }

  #scheme-Paradox #post-toc-trigger-btn {
    color: #757575;
  }

  .post-toc a:hover {
    color: #00838F;
    text-decoration: underline;
  }

</style>


<!-- Theme Background Related-->

    <style>
      body{
        background-color: #F5F5F5;
      }

      /* blog_info bottom background */
      #scheme-Paradox .material-layout .something-else .mdl-card__supporting-text{
        background-color: #fff;
      }
    </style>




<!-- Fade Effect -->

    <style>
      .fade {
        transition: all 800ms linear;
        -webkit-transform: translate3d(0,0,0);
        -moz-transform: translate3d(0,0,0);
        -ms-transform: translate3d(0,0,0);
        -o-transform: translate3d(0,0,0);
        transform: translate3d(0,0,0);
        opacity: 1;
      }

      .fade.out{
        opacity: 0;
      }
    </style>


<!-- Import Font -->
<!-- Import Roboto -->

    <link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500" rel="stylesheet">


<!-- Import Material Icon -->

    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">




    <!-- Import jQuery -->
    
        <script>lsloader.load("jq_js","/js/jquery.min.js?qcusAULNeBksqffqUM2+Ig==", true)</script>
    

    <!-- The Open Graph protocol -->
    <meta property="og:url" content="http://www.swanlinux.net">
    <meta property="og:type" content="blog">
    <meta property="og:title" content="RTB 广告优化 ---- 在线平滑投放实现 | Iodsp">
    <meta property="og:image" content="http://www.swanlinux.net/img/iodsp.png" />
    <meta property="og:description" content="">
    <meta property="og:article:tag" content="平滑投放"> <meta property="og:article:tag" content="RTB"> <meta property="og:article:tag" content="广告优化"> 

    
        <meta property="article:published_time" content="Fri Feb 10 2017 09:13:16 GMT+0800" />
        <meta property="article:modified_time" content="Tue Jan 30 2018 14:30:34 GMT+0800" />
    

    <!-- The Twitter Card protocol -->
    <meta name="twitter:title" content="RTB 广告优化 ---- 在线平滑投放实现 | Iodsp">
    <meta name="twitter:description" content="">
    <meta name="twitter:image" content="http://www.swanlinux.net/img/iodsp.png">
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:url" content="http://www.swanlinux.net" />

    <!-- Add canonical link for SEO -->
    
        <link rel="canonical" href="http://www.swanlinux.net/2017/02/10/papers/real_time_bid_optimization/index.html" />
    

    <!-- Structured-data for SEO -->
    
        


<script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "BlogPosting",
    "mainEntityOfPage": "http://www.swanlinux.net/2017/02/10/papers/real_time_bid_optimization/index.html",
    "headline": "RTB 广告优化 ---- 在线平滑投放实现",
    "datePublished": "Fri Feb 10 2017 09:13:16 GMT+0800",
    "dateModified": "Tue Jan 30 2018 14:30:34 GMT+0800",
    "author": {
        "@type": "Person",
        "name": "Nmred",
        "image": {
            "@type": "ImageObject",
            "url": "/img/avatar.jpg"
        },
        "description": "Everything in order to facilitate"
    },
    "publisher": {
        "@type": "Organization",
        "name": "Iodsp",
        "logo": {
            "@type":"ImageObject",
            "url": "/img/iodsp.png"
        }
    },
    "keywords": ",平滑投放,RTB,广告优化",
    "description": "",
}
</script>


    

    <!-- Analytics -->
    
    
    

    <!-- Custom Head -->
    

</head>


    
        <body id="scheme-Paradox" class="lazy">
            <div class="material-layout  mdl-js-layout has-drawer is-upgraded">
                

                <!-- Main Container -->
                <main class="material-layout__content" id="main">

                    <!-- Top Anchor -->
                    <div id="top"></div>

                    
                        <!-- Hamburger Button -->
                        <button class="MD-burger-icon sidebar-toggle">
                            <span class="MD-burger-layer"></span>
                        </button>
                    

                    <!-- Post TOC -->

    
    <!-- Back Button -->
    <!--
    <div class="material-back" id="backhome-div" tabindex="0">
        <a class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon"
           href="#" onclick="window.history.back();return false;"
           target="_self"
           role="button"
           data-upgraded=",MaterialButton,MaterialRipple">
            <i class="material-icons" role="presentation">arrow_back</i>
            <span class="mdl-button__ripple-container">
                <span class="mdl-ripple"></span>
            </span>
        </a>
    </div>
    -->


    <!-- Left aligned menu below button -->
    
    
    <button id="post-toc-trigger-btn"
        class="mdl-button mdl-js-button mdl-button--icon">
        <i class="material-icons">format_list_numbered</i>
    </button>

    <ul class="post-toc-wrap mdl-menu mdl-menu--bottom-left mdl-js-menu mdl-js-ripple-effect" for="post-toc-trigger-btn" style="max-height:80vh; overflow-y:scroll;">
        <ol class="post-toc"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#概述-amp-介绍"><span class="post-toc-number">1.</span> <span class="post-toc-text">概述 & 介绍</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#为什么做平滑投放"><span class="post-toc-number">1.1.</span> <span class="post-toc-text">为什么做平滑投放</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#实时广告优化目标"><span class="post-toc-number">1.2.</span> <span class="post-toc-text">实时广告优化目标</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#解决的问题"><span class="post-toc-number">1.3.</span> <span class="post-toc-text">解决的问题</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#解决问题方式"><span class="post-toc-number">1.4.</span> <span class="post-toc-text">解决问题方式</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#实时广告优化的挑战"><span class="post-toc-number">1.5.</span> <span class="post-toc-text">实时广告优化的挑战</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#背景与相关工作"><span class="post-toc-number">2.</span> <span class="post-toc-text">背景与相关工作</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#问题"><span class="post-toc-number">2.1.</span> <span class="post-toc-text">问题</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#解决"><span class="post-toc-number">2.2.</span> <span class="post-toc-text">解决</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#相关解决办法"><span class="post-toc-number">2.3.</span> <span class="post-toc-text">相关解决办法</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#在线广告优化"><span class="post-toc-number">3.</span> <span class="post-toc-text">在线广告优化</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#平滑投放预算计算"><span class="post-toc-number">3.1.</span> <span class="post-toc-text">平滑投放预算计算</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#选择高质量广告请求-—-固定-CPM-模式"><span class="post-toc-number">3.2.</span> <span class="post-toc-text">选择高质量广告请求 — 固定 CPM 模式</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#选择高质量广告请求-—-动态-CPM-模式"><span class="post-toc-number">3.3.</span> <span class="post-toc-text">选择高质量广告请求 — 动态 CPM 模式</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#CTR-和-AR-预估"><span class="post-toc-number">4.</span> <span class="post-toc-text">CTR 和 AR 预估</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#参考资料"><span class="post-toc-number">5.</span> <span class="post-toc-text">参考资料</span></a></li></ol>
    </ul>
    




<!-- Layouts -->

    <!-- Post Module -->
    <div class="material-post_container">

        <div class="material-post mdl-grid">
            <div class="mdl-card mdl-shadow--4dp mdl-cell mdl-cell--12-col">

                <!-- Post Header(Thumbnail & Title) -->
                
    <!-- Paradox Post Header -->
    
        
            <!-- Random Thumbnail -->
            <div class="post_thumbnail-random mdl-card__media mdl-color-text--grey-50">
            <script type="text/ls-javascript" id="post-thumbnail-script">
    var randomNum = Math.floor(Math.random() * 19 + 1);

    $('.post_thumbnail-random').attr('data-original', '/img/random/material-' + randomNum + '.png');
    $('.post_thumbnail-random').addClass('lazy');
</script>

        
    
            <p class="article-headline-p">
                RTB 广告优化 ---- 在线平滑投放实现
            </p>
        </div>





                
                    <!-- Paradox Post Info -->
                    <div class="mdl-color-text--grey-700 mdl-card__supporting-text meta">

    <!-- Author Avatar -->
    <div id="author-avatar">
        <img src="/img/avatar.jpg" width="44px" height="44px" alt="Author Avatar"/>
    </div>
    <!-- Author Name & Date -->
    <div>
        <strong>Nmred</strong>
        <span>2月 10, 2017</span>
    </div>

    <div class="section-spacer"></div>

    <!-- Favorite -->
    <!--
        <button id="article-functions-like-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon btn-like">
            <i class="material-icons" role="presentation">favorite</i>
            <span class="visuallyhidden">favorites</span>
        </button>
    -->

    <!-- Qrcode -->
    
        <button id="article-functions-qrcode-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
    <i class="material-icons" role="presentation">devices other</i>
    <span class="visuallyhidden">devices other</span>
</button>
<ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-functions-qrcode-button">
    <li class="mdl-menu__item">在其它设备中阅读本文章</li>
    
        <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAPYAAAD2CAAAAADAeSUUAAAC2ElEQVR42u3aS3LbMBAFQN7/0snWC0d+b0BHItBYqVgUiCYXU/O5/hy5LmxsbGxsbGxsbOyPZF/x+nr/v/77zcPiewpAeWZsbGzsE9jJY+76HR3x5ZX2zNjY2NjnsPOg1Qab10Eoub5yZmxsbGzsJMDMwlV7DzY2Njb2bwSwNhTl+8/SG2xsbOyT2W06kbQB2rCUh8b/WkvDxsbG/nj2SqP3Xb/f3N/GxsbG/hj2bM2GePKRnYRRnxkbGxt7U3b+yNlQZtsezvesXzo2Njb2puy8eNQ2X/N2wmxIKE9CsLGxsfdmt8dqi/jtGFDbWijSG2xsbOyt2UWRPR7NaY+4vvPNXRFsbGzsh7BXHpyXe2YFo3xkJ7qCjY2NvTV79oAk2WjHbtqCUd4GxsbGxj6HnRR6Voo+0RHLV3nz8CU2Njb2o9h5SMgHaNrXsdJsSIpW2NjY2Oew898rLdg2BWpfUx3AsLGxsR/OXk9L8mSjHd9Zb0hgY2Njn8leCR7J9dkY5SzQYmNjY5/AnpV+1luzdzUG8hCIjY2NvSu7ZcxauTPA7AMUqQg2Njb2Ruy2lZvzVjB5iSp5BdjY2Ni7stsBnd8IcnftsJSBYWNjYz+c3bZjkwCTF5Lahm7busDGxsbem73SWF0f3Mkbw7NCEjY2NvYJ7DYU5UGuDWN5kpOcBBsbG/s09qxkU5d14kGcWTr0QxEKGxsbe2v2rInblpzyscs2RYk+AzY2NvZh7DzItUWlWUvgermiHbCxsbE3Za8fa+VAeamoDWx1VwQbGxv7sewrXrOyTrJD/srypKiopWFjY2NvwU6C1uz+/HoOuy2AYWNjY2/HXglaSbGpHei5yvXDbtjY2NjYAXW99J+cpG1CY2NjY2O3Rfy2MdC2bPNiEzY2NvZp7DZJaJvBdyGHyQk2Njb21uy2Tds2AGaBJ39u9KmwsbGxN2Wfs7CxsbGxsbGxsbE/Zv0FS85JS5X5fAIAAAAASUVORK5CYII=">
    
</ul>

    

    <!-- Tags (bookmark) -->
    
    <button id="article-functions-viewtags-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
        <i class="material-icons" role="presentation">bookmark</i>
        <span class="visuallyhidden">bookmark</span>
    </button>
    <ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-functions-viewtags-button">
        <li class="mdl-menu__item">
        <a class="post_tag-link" href="/tags/RTB/">RTB</a></li><li class="mdl-menu__item"><a class="post_tag-link" href="/tags/平滑投放/">平滑投放</a></li><li class="mdl-menu__item"><a class="post_tag-link" href="/tags/广告优化/">广告优化</a>
    </ul>
    

    <!-- Share -->
    <button id="article-fuctions-share-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
    <i class="material-icons" role="presentation">share</i>
    <span class="visuallyhidden">share</span>
</button>
<ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-fuctions-share-button">
    

    

    <!-- Share Weibo -->
    
        <a class="post_share-link" href="http://service.weibo.com/share/share.php?appkey=&title=RTB 广告优化 ---- 在线平滑投放实现&url=http://www.swanlinux.net/2017/02/10/papers/real_time_bid_optimization/index.html&pic=http://www.swanlinux.net/img/iodsp.png&searchPic=false&style=simple" target="_blank">
            <li class="mdl-menu__item">
                分享到微博
            </li>
        </a>
    

    <!-- Share Twitter -->
    
        <a class="post_share-link" href="https://twitter.com/intent/tweet?text=RTB 广告优化 ---- 在线平滑投放实现&url=http://www.swanlinux.net/2017/02/10/papers/real_time_bid_optimization/index.html&via=Nmred" target="_blank">
            <li class="mdl-menu__item">
                分享到 Twitter
            </li>
        </a>
    

    <!-- Share Facebook -->
    
        <a class="post_share-link" href="https://www.facebook.com/sharer/sharer.php?u=http://www.swanlinux.net/2017/02/10/papers/real_time_bid_optimization/index.html" target="_blank">
            <li class="mdl-menu__item">
                分享到 Facebook
            </li>
        </a>
    

    <!-- Share Google+ -->
    
        <a class="post_share-link" href="https://plus.google.com/share?url=http://www.swanlinux.net/2017/02/10/papers/real_time_bid_optimization/index.html" target="_blank">
            <li class="mdl-menu__item">
                分享到 Google+
            </li>
        </a>
    

    <!-- Share LinkedIn -->
    

    <!-- Share QQ -->
    

    <!-- Share Telegram -->
    
</ul>

</div>

                

                <!-- Post Content -->
                <div id="post-content" class="mdl-color-text--grey-700 mdl-card__supporting-text fade out">
    
        <h2 id="概述-amp-介绍"><a href="#概述-amp-介绍" class="headerlink" title="概述 &amp; 介绍"></a>概述 &amp; 介绍</h2><h3 id="为什么做平滑投放"><a href="#为什么做平滑投放" class="headerlink" title="为什么做平滑投放"></a>为什么做平滑投放</h3><ul>
<li>广告主通过采买一定量的展示量尽可能的触达更多的用户，产生对应的互动</li>
<li>在一段时间内，平滑的消费预算为了可以触达更广范围内的用户，并且持续产生影响</li>
</ul>
<h3 id="实时广告优化目标"><a href="#实时广告优化目标" class="headerlink" title="实时广告优化目标"></a>实时广告优化目标</h3><ul>
<li>在有限的预算内实现优化目标最大化</li>
<li>尽可能的降低 CPC (cost per click) CPA (const per action)</li>
<li>尽可能的提升 CTR (click through rate) AT (action through rate)</li>
</ul>
<h3 id="解决的问题"><a href="#解决的问题" class="headerlink" title="解决的问题"></a>解决的问题</h3><ul>
<li>防止过早的消费完预算</li>
<li>避免突发性的消费</li>
<li>避免在流量峰值上投放过多的广告，保证广告的可持续影响和触达范围</li>
</ul>
<h3 id="解决问题方式"><a href="#解决问题方式" class="headerlink" title="解决问题方式"></a>解决问题方式</h3><ul>
<li>基于历史指标分布通过选择高质量展示和调整竞价来实现时间区间预算最佳分配</li>
</ul>
<h3 id="实时广告优化的挑战"><a href="#实时广告优化的挑战" class="headerlink" title="实时广告优化的挑战"></a>实时广告优化的挑战</h3><ul>
<li>低延迟，高吞吐量</li>
<li>优化参考指标信息延迟，比如反馈信息延迟、收集的点击日志处理延迟、或者关联的广告展示对应的交互可能几天后才会产生等</li>
<li>对于非搜索类的广告转化低，因此在评估历史的指标时方差特别大</li>
</ul>
<h2 id="背景与相关工作"><a href="#背景与相关工作" class="headerlink" title="背景与相关工作"></a>背景与相关工作</h2><h3 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h3><ul>
<li>过早的消费完预算</li>
</ul>
<p><img src="/image/papers/real_time_bid_optimization/figure_1_a.png" alt=""></p>
<ul>
<li>预算消费波动太大</li>
</ul>
<p><img src="/image/papers/real_time_bid_optimization/figure_1_b.png" alt=""></p>
<h3 id="解决"><a href="#解决" class="headerlink" title="解决"></a>解决</h3><p>通常解决办法是采用平均预算的方式如图所示：</p>
<p><img src="/image/papers/real_time_bid_optimization/figure_1_c.png" alt=""></p>
<p>但是这个有两个问题：</p>
<ul>
<li><p>流量问题</p>
<p>比如通过定向条件过滤后的流量上午多余下午，按照平均预算的策略可能上午还有一定的流量空余，而下午由于流量小可能要强制投放一些效果差的广告</p>
<p>通过和流量关联来解决这个问题，如图：</p>
<p><img src="/image/papers/real_time_bid_optimization/figure_1_d.png" alt=""></p>
</li>
</ul>
<ul>
<li><p>效果问题</p>
<p>和流量问题类似，如果平均预算策略可能会导致优质流量时段没有预算大量投放，所以通过和效果来关联解决这个问题，如图：</p>
<p><img src="/image/papers/real_time_bid_optimization/figure_1_e.png" alt=""></p>
<p>不过这种方式有一个潜在的问题就是当一个小的区间质量特别高会出现预算波动的问题，违背了平滑投放的限制,平衡流量和效果两个指标有一定的挑战，这个论文就是解决这两个指标的同步问题</p>
</li>
</ul>
<p>为了实现平滑投放，我们将总体的日常预算 <code>B</code> 按时间空档序列分配为 <code>{b1,....,bt}</code> 其中 <code>bt</code> 就是时间空档 <code>t</code> 的预算,接下来就是我们通过不同的分配 <code>bt</code> 策略来选择出高质量的展示流量, 综上所述可以总结为如下数学问题：</p>
<p> <img src="http://latex.codecogs.com/gif.latex?maximize%20%5C%20%5C%20%5C%20%5C%20%5C%20%5Csum_%7Bn%7D%5E%7Bi%3D1%7Dv_%7Bi%7Dx_%7Bi%7D" alt=""></p>
<p> <img src="http://latex.codecogs.com/gif.latex?subject%20%5C%20%5C%20to%20%5C%20%5C%20%5C%20%5C%20%5Csum_%7Bj%5Cin%20%5Cmathbb%7BI%7D_t%7Dc_%7Bj%7Dx_%7Bj%7D%20%5Cleq%20b_%7Bt%7D%20%5C%20%5C%20%5C%20%5C%20%5C%20%5C%20%5Cforall%20_%7Bt%7D%20%5Cin%20%5Cleft%20%5C%7B%201%2C....%2CT%20%5Cright%20%5C%7D" alt=""></p>
<p><a href="maximize      \ \ \ \ \  \sum_{n}^{i=1}v_{i}x_{i}"></a></p>
<p><a href="subject \  \  to \ \ \ \ \sum_{j\in \mathbb{I}_t}c_{j}x_{j} \leq b_{t} \ \ \ \ \ \ \forall _{t} \in \left \{ 1,....,T \right \}"></a></p>
<p>这块的 <img src="http://latex.codecogs.com/gif.latex?%5Cmathbb%7BI%7D_t" alt=""> 代表在时间空档 <code>t</code> 中的所有广告请求集合。当广告请求 <code>i</code> 请求时，算法必须要给出 <img src="http://latex.codecogs.com/gif.latex?x_i" alt=""> , 在优化过程中也需要给出一个投放价格 <img src="http://latex.codecogs.com/gif.latex?%5Cwidehat%7Bc_i%7D" alt=""> 预估值，这个并不是真正的消费预算，因为一般的 ADX 都是第二定价，所以 <img src="http://latex.codecogs.com/gif.latex?%5Cwidehat%7Bc_i%7D%3Dc_i%20&plus;%20%5Cepsilon%20_i" alt=""> , 其中 <img src="http://latex.codecogs.com/gif.latex?c_i" alt=""> 才是真正的消费价格。</p>
<h3 id="相关解决办法"><a href="#相关解决办法" class="headerlink" title="相关解决办法"></a>相关解决办法</h3><p>对于表达式一是典型的线性回归问题，对于 <code>Zhou et al. [21] modeled the budget constrained bidding optimization problem as an online knapsack problem</code> 中采用了一个简单的策略，基于一个指数函数和以前的预算相关联来完成广告高质量的筛选， 随着迭代，这个方法选择的质量越来越高，但是这个算法的前提是有无限的广告供应，这个对于 RTB 竞价广告定向后的广告量来说是不可能实现的。</p>
<p>对于 <code>Babaio↵ et al. [5] formulated the problem of dynamic bidding price</code> 中提到的使用 多臂老虎机， 采用这个策略的置信区间的上间来优化价格。这个方法不需要任何历史分布，但是多臂老虎机需要快速的反馈数据, 而对于 RTB 交易的展示广告这些指标有很大的延迟</p>
<p>对于 <code>Agrawal et al. [3] proposed an general online linear pro- gramming algorithm to solve many practical online prob- lems</code> 首先采用标准线性回归的方法基于目前系统的数据计算出对偶最优解。问题是每个广告请求到达时， <img src="http://latex.codecogs.com/gif.latex?v_i" alt=""> (决定是否展示的变量0， 1) 和  <img src="http://latex.codecogs.com/gif.latex?c_i" alt=""> 真正的值是未知的，如果采用统计预估的方式计算的话，每次都需要重新计算对偶解，这样对于实时竞价的广告来说会产生巨大的计算量</p>
<h2 id="在线广告优化"><a href="#在线广告优化" class="headerlink" title="在线广告优化"></a>在线广告优化</h2><p>通过出价方式将优化的广告系列分为：</p>
<ul>
<li>固定出价的 CPM 广告</li>
<li>动态出价的 CPM 广告（dcpm）</li>
</ul>
<p>对于固定出价的 CPM 广告关注的目标指标是 CTR 、AR , 对于动态出价的 CPM 关注的是 ecpc 和 ecpa ，不管是什么类型的广告，优化目标可以总结为如下：</p>
<p><img src="http://latex.codecogs.com/gif.latex?min%20%5C%20%5C%20%5C%20-CTR%2C%20-AR%20%2CeCPC%20%5C%20or%20%5C%20eCPA" alt=""></p>
<p><img src="http://latex.codecogs.com/gif.latex?s.t.%20%5C%20%5C%20%5C%20%7C%5Csum_%7Bt%7D%5E%7BT%7Ds%28t%29%20-%20B%20%7C%20%5Cleq%20%5Cvarepsilon" alt=""></p>
<p><img src="http://latex.codecogs.com/gif.latex?%5C%20%5C%20%5C%20%5C%20%5C%20%5C%20%5C%20%7Cs%28t%29%20-%20b_t%7C%20%5Cleq%20%5Cdelta%20_t%20%5C%20%5C%20%5C%20%5C%20%5C%20%5C%20%5Cforall%20%5Cin%20%5Cleft%20%5C%7B%201%2C.....%2CT%20%5Cright%20%5C%7D" alt=""></p>
<p><img src="http://latex.codecogs.com/gif.latex?eCPM%20%5Cleq%20M" alt=""></p>
<p>首先是对整体日消费额度的限制，其中 <code>s(t)</code> 表示在时间空档 <code>t</code> 中消费的额度， 第二个约束是根据额度 <img src="http://latex.codecogs.com/gif.latex?b_t" alt=""> 在一个时间空档中进行分配达到平滑投放，最后一个是要求平均出价 eCPM 要小于最大出价限度 <code>M</code></p>
<p>根据上述构想，我们需要优化的参数是 <img src="http://latex.codecogs.com/gif.latex?b_t" alt=""> ， 因为日消费额度 <code>B</code> 和 最大出价限度 <code>M</code> 是广告主自行设定。</p>
<p><a href="min \ \ \ -CTR, -AR ,eCPC \ or \ eCPA"></a><br><a href="s.t. \ \ \ |\sum_{t}^{T}s(t"></a> - B | \leq  \varepsilon )<br><a href="\ \ \ \  \ \ \  |s(t"></a> - b_t| \leq \delta _t \ \ \ \ \ \ \forall \in \left { 1,…..,T \right })<br><a href="eCPM \leq M"></a></p>
<h3 id="平滑投放预算计算"><a href="#平滑投放预算计算" class="headerlink" title="平滑投放预算计算"></a>平滑投放预算计算</h3><p>采用将整天拆分为 T 个时间空档，每个时间空档每个系列广告分配一定的预算， 在一个时间空档 <code>t</code> 中消费的预算和获取到的展示量是成比例的，因为我们假设在一个时间空档中每个独立的展示的价格大约是一致的，这个在实际应用中价格的方差是很小的，所以可以假设在一个 slot 中价格是一个常量。</p>
<p>对于每个广告系列我们分配一个竞价率，竞价率的定义就是参与竞价的请求量 (bids) 和总请求量(reqs)的比值, 通过表达式 (1) 我们可以推算出竞价率的另外一种表达式：</p>
<p><img src="http://latex.codecogs.com/gif.latex?%5Cdpi%7B150%7D%20s%28t%29%20%3D%20%5Csum_%7Bj%5Cin%20%5Cmathbb%7BI%7D_t%7Dc_jx_j%20%5Cpropto%20reqs%28t%29%20%5Cfrac%7Bbids%28t%29%7D%7Breqs%28t%29%7D%5Cfrac%7Bimps%28t%29%7D%7Bbids%28t%29%7D" alt=""></p>
<p><img src="http://latex.codecogs.com/gif.latex?%5Cdpi%7B150%7D%20%5Cpropto%20reqs%28t%29%5Ccdot%20pacing%5C_rate%28t%29%5Ccdot%20win%5C_rate%28t%29" alt=""></p>
<p><a href="s(t"></a> = \sum_{j\in \mathbb{I}_t}c_jx_j \propto reqs(t) \frac{bids(t)}{reqs(t)}\frac{imps(t)}{bids(t)}<br>\propto reqs(t)\cdot pacing_rate(t)\cdot win_rate(t))</p>
<p>接下来我们通过获取到前一个 slot 的竞价率和消耗来调整当前的竞价率， 通过上述公式递归得出：</p>
<p><img src="http://latex.codecogs.com/gif.latex?%5Cdpi%7B150%7D%20%5Cfrac%7Breqs%28t%29%5Ccdot%20pacing%5C_rate%28t%29%5Ccdot%20win%5C_rate%28t%29%20%7D%7Breqs%28t&plus;1%29%5Ccdot%20pacing%5C_rate%28t&plus;1%29%5Ccdot%20win%5C_rate%28t&plus;1%29%20%7D%20%3D%20%5Cfrac%7Bs%28t%29%7D%7Bs%28t&plus;1%29%29%7D" alt=""></p>
<p><img src="http://latex.codecogs.com/gif.latex?%5Cdpi%7B150%7D%20%5Cpropto%20pacing%5C_rate%28t&plus;1%29%20%3D%20pacing%5C_rate%28t%29%5Cfrac%7Bs%28t&plus;1%29%5Ccdot%20reqs%28t%29%5Ccdot%20win%5C_rate%28t%29%20%7D%7Bs%28t%29%5Ccdot%20reqs%28t&plus;1%29%5Ccdot%20win%5C_rate%28t&plus;1%29%20%7D" alt=""></p>
<p><img src="http://latex.codecogs.com/gif.latex?%5Cdpi%7B150%7D%20%5Cpropto%20pacing%5C_rate%28t&plus;1%29%20%3D%20pacing%5C_rate%28t%29%5Cfrac%7B%7B%5Ccolor%7BRed%7D%20b_%7Bt&plus;1%7D%7D%5Ccdot%20reqs%28t%29%5Ccdot%20win%5C_rate%28t%29%20%7D%7Bs%28t%29%5Ccdot%20reqs%28t&plus;1%29%5Ccdot%20win%5C_rate%28t&plus;1%29%20%7D" alt=""></p>
<p>通过上述转化 如果要求得一个竞价率 <code>pacing_rate(t+1)</code> 需要通过上次的请求量、竞价成功率、消耗、本次竞价成功率、本次请求量、本次预算来得出， 其中上次的数据是已知的，本次竞价成功率、本次请求可以通过历史数据预测，目前需要确定的数据指标只有 <img src="http://latex.codecogs.com/gif.latex?b_{t+1}" alt="">, 只要求出该值对应的竞价率就会得出</p>
<p>假设我们采用同样的竞价率的策略，那么计算 <img src="http://latex.codecogs.com/gif.latex?b_{t+1}" alt=""> 公式如下：</p>
<p><img src="http://latex.codecogs.com/gif.latex?%5Cdpi%7B150%7D%20b_%7Bt&plus;1%7D%5Eu%20%3D%20%5Cleft%20%28%20B%20-%20%5Csum_%7Bm%3D1%7D%5E%7Bt%7D%20s%28m%29%5Cright%20%29%5Cfrac%7BL%28t&plus;1%29%7D%7B%5Csum_%7Bm%3Dt&plus;1%7D%5E%7BT%7DL%28m%29%29%7D" alt=""></p>
<p>其中 <code>L(t+1)</code> 代表第 <code>t+1</code> 个时间空档的时间长度， 如果每个时间空档长度相同那么该表达式可以转化为：</p>
<p><img src="http://latex.codecogs.com/gif.latex?%5Cdpi%7B150%7D%20b_%7Bt&plus;1%7D%5Eu%20%3D%20%5Cleft%20%28%20B%20-%20%5Csum_%7Bm%3D1%7D%5E%7Bt%7D%20s%28m%29%5Cright%20%29%5Cfrac%7B1%7D%7BT-t%7D" alt=""></p>
<p><strong>但是在上面也讨论了同竞价率的平滑策略的问题，所以我们需要改善策略</strong>， 我们需要在一个 slot 内消耗固定的额度来尽可能的提升转化，我们需要构建一个概率密度函数描述某个转化指标在在单个时间空档发生的概率密度： <code>p0,....pT</code> 假设一天有 T 个时间空档，并且 <img src="http://latex.codecogs.com/gif.latex?%5Cinline%20%5Cdpi%7B150%7D%20%5Csum_%7Bt%7D%5E%7BT%7Dp_t%20%3D%201" alt=""> 。通过加入转化指标的因子来尽可能的提升转化率，加入转化因子后的理想的消耗计算方法变为：</p>
<p><img src="http://latex.codecogs.com/gif.latex?%5Cinline%20%5Cdpi%7B150%7D%20b_%7Bt&plus;1%7D%5Ep%20%3D%20%5Cleft%20%28%20B-%5Csum_%7Bm%3D1%7D%5E%7Bt%7D%20s%28m%29%5Cright%20%29%5Cfrac%7Bp_%7Bt&plus;1%7D%5Ccdot%20L%28t&plus;1%29%7D%7B%5Csum_%7Bm%3Dt&plus;1%7D%5E%7BT%7Dp_m%5Ccdot%20L%28m%29%7D" alt=""></p>
<p>如果时间空档相同则：</p>
<p><img src="http://latex.codecogs.com/gif.latex?%5Cinline%20%5Cdpi%7B150%7D%20b_%7Bt&plus;1%7D%5Ep%20%3D%20%5Cleft%20%28%20B-%5Csum_%7Bm%3D1%7D%5E%7Bt%7D%20s%28m%29%5Cright%20%29%5Cfrac%7Bp_%7Bt&plus;1%7D%7D%7B%5Csum_%7Bm%3Dt&plus;1%7D%5E%7BT%7Dp_m%7D" alt=""></p>
<p>在实践中可能会遇到 <img src="http://latex.codecogs.com/gif.latex?p_j" alt=""> 为 0 的时候，这将会导致没有预算来投放，为了避免这种情况的发送我们可以结合平均竞价率策略和该策略混合使用。</p>
<p><strong>概率密度相关计算</strong></p>
<p> <img src="http://latex.codecogs.com/gif.latex?p_j" alt=""> 计算可以通过 当前时间空档转化个数除以整天转化个数计算出当前空档的概率分布密度，依次类推</p>
<h3 id="选择高质量广告请求-—-固定-CPM-模式"><a href="#选择高质量广告请求-—-固定-CPM-模式" class="headerlink" title="选择高质量广告请求 — 固定 CPM 模式"></a>选择高质量广告请求 — 固定 CPM 模式</h3><p>对于 固定 CPM 模式的广告，出价永远是固定  <img src="http://latex.codecogs.com/gif.latex?c^*" alt=""> , 我们需要做的优化就是如何在当前价格、当前竞价率条件下选择出高质量的广告。当广告请求到达时我们并不知道这个广告的真实价值，我们需要借助 CTR 或者 AR 预估系统来预估一个价值。</p>
<p>为了满足平滑策略可知：</p>
<p><img src="http://latex.codecogs.com/gif.latex?%5Cinline%20%5Cdpi%7B150%7D%20imps%5E*%28t%29%20%3D%20%5Cfrac%7Bs%28t%29%7D%7Bc%5E*%7D" alt=""></p>
<p>通过竞价胜率可得：</p>
<p><img src="http://latex.codecogs.com/gif.latex?%5Cinline%20%5Cdpi%7B150%7D%20reqs%5E*%28t%29%20%3D%20%5Cfrac%7Bimps%5E*%28t%29%7D%7Bwin%5C_rate%28t%29%7D" alt=""></p>
<p>同上，采用竞价率可以预估出来本时间区间需要接受的请求数 :</p>
<p><img src="http://latex.codecogs.com/gif.latex?%5Cdpi%7B150%7D%20reqs%5E*%28t%29%20%3D%20%5Cfrac%7Bbids%5E*%28t%29%7D%7Bpacing%5C_rate%28t%29%29%7D" alt=""></p>
<p>通过每个广告系列的历史数据构建一个指数直方图，如图：</p>
<p><img src="/image/papers/real_time_bid_optimization/figure_2.png" alt=""></p>
<p>其中分布函数 <img src="http://latex.codecogs.com/gif.latex?q_t(x" alt="">) 代表在 时间空档 t 中 CTR 或者 AR 是 x 的请求个数， 我们的在线算法其实就是要在时间空档 t 中找一个阀值 <img src="http://latex.codecogs.com/gif.latex?%5Cinline%20%5Cdpi%7B150%7D%20%5Ctau%28t%29" alt=""> 来过滤满足平滑策略但 CTR 或者 AR 低于该阀值的请求，所以该阀值可以表示为：</p>
<p><img src="http://latex.codecogs.com/gif.latex?%5Cinline%20%5Cdpi%7B150%7D%20%5Ctau%28t%29%20%3D%20arg%20%5C%20min_x%20%7C%20%5Cint_%7Bx%7D%5E%7B1%7Dq_t%28x%29dx%20-%20reqs%5E*%28t%29%7C" alt=""></p>
<p>在实践中由于 CTR 或者 AR 分布不需要经常计算，如果 <img src="http://latex.codecogs.com/gif.latex?q_t(x" alt="">)  不是很接近当前请求分布时，会导致当前时间空档的阈值震荡。由于 <img src="http://latex.codecogs.com/gif.latex?q_t(x" alt="">) 分布时通过历史数据生成，所以产生这种情况很正常，为了避免这种情况，我们将阈值改为一个可信区间。首先我们通过计算这个阈值的平均值和方差，并且通过中心极限定理推断  <img src="http://latex.codecogs.com/gif.latex?%5Cinline%20%5Cdpi%7B150%7D%20%5Ctau%28t%29" alt=""> 是满足高斯分布的，所以可信区间通过如下公式计算：</p>
<p>上限：<img src="http://latex.codecogs.com/gif.latex?%5Cinline%20%5Cdpi%7B150%7D%20%5Cmu_%5Ctau%20%28t%29%20&plus;%20%5Cgamma%20%5Cfrac%7B%5Csigma%20_%5Ctau%20%28t%29%29%7D%7B%5Csqrt%7Bd%7D%7D" alt=""></p>
<p>下限：<img src="http://latex.codecogs.com/gif.latex?%5Cinline%20%5Cdpi%7B150%7D%20%5Cmu_%5Ctau%20%28t%29%20-%20%5Cgamma%20%5Cfrac%7B%5Csigma%20_%5Ctau%20%28t%29%29%7D%7B%5Csqrt%7Bd%7D%7D" alt=""></p>
<p>其中 <img src="http://latex.codecogs.com/gif.latex?%5Cinline%20%5Cdpi%7B150%7D%20%5Cmu_%5Ctau%20%28t%29" alt=""> 为阈值平均值，<img src="http://latex.codecogs.com/gif.latex?%5Cinline%20%5Cdpi%7B150%7D%20%5Csigma%20_%5Ctau%20%28t%29" alt=""> 为阈值方差， <code>d</code> 为计算该分布函数的历史数据的天数</p>
<p>对于常数 <img src="http://latex.codecogs.com/gif.latex?%5Cinline%20%5Cdpi%7B150%7D%20%5Cgamma" alt=""> = 1.96 时计算的是 95%的可信区间</p>
<p><strong>这个阈值的上下限在每个时间空档都会更新</strong></p>
<p>和平滑策略合并在一块可以总结为：</p>
<ul>
<li>当预测的 CTR 或者 AR 的值 大于阈值的上限直接参与竞价</li>
<li>当预测的 CTR 或者 AR 的值 介于阈值的上下限之间，则采用正常的竞价率计算竞价</li>
<li>当预测的 CTR 或者 AR 的值 小于阈值的下限则不参与竞价</li>
</ul>
<h3 id="选择高质量广告请求-—-动态-CPM-模式"><a href="#选择高质量广告请求-—-动态-CPM-模式" class="headerlink" title="选择高质量广告请求 — 动态 CPM 模式"></a>选择高质量广告请求 — 动态 CPM 模式</h3><p>对于 dcpm 类型的广告，是通过动态的调整价格，来满足平滑预算。并且竞价率 (pacing_rate) 控制参与竞价的频率，如果竞价价格不是很高可能会在公开竞价过程中失败，如果太高可能会增加预算，即使是第二定价的情况下也一样。为了调整竞价价格，我们定义了两个阈值： <img src="http://latex.codecogs.com/gif.latex?%5Cinline%20%5Cdpi%7B150%7D%200%20%5Cleq%20%5Cbeta_1%20%5Cleq%20%5Cbeta_2%20%5Cleq%201" alt=""> , 我们可以通过竞价率分为三个区域： </p>
<ul>
<li>安全区： <img src="http://latex.codecogs.com/gif.latex?%5Cinline%20%5Cdpi%7B150%7D%20pacing%5C_rate%28t%29%20%5Cleq%20%5Cbeta_1" alt=""> 在该区域一般由于受众定向比较宽泛的原因很容易消耗预算</li>
<li>临界区： <img src="http://latex.codecogs.com/gif.latex?%5Cinline%20%5Cdpi%7B150%7D%20%5Cbeta_1%20%5Cleq%20pacing%5C_rate%28t%29%20%5Cleq%20%5Cbeta_2" alt=""> 在该区域内表示投放正常</li>
<li>危险区：<img src="http://latex.codecogs.com/gif.latex?%5Cinline%20%5Cdpi%7B150%7D%20%5Cbeta_2%20%5Cleq%20pacing%5C_rate%28t%29" alt=""> 表示很难找到合适的展示广告或者很难竞价成功</li>
</ul>
<p>后面我们分开讨论：</p>
<p>典型的 dcpm 是为了完成某个目标值 G 的，通常是 CPA(eCPA) ，我们可以用这个目标值来定义一个底价即： <img src="http://latex.codecogs.com/gif.latex?%5Cinline%20%5Cdpi%7B150%7D%20%5Cmu_i%20%3D%20AR%20%5Ctimes%20G" alt="">, 其中 <code>AR</code> 是通过预估模块计算出的本次请求的 AR 值。</p>
<p>对于临界区的直接提交这个价格竞价即可</p>
<p>对于安全区我们需要通过第二定价来不断的学习一个最优的价格，因为竞价出价和第二价格之间的差异正好反映了当前展示的广告质量和我们预估的展示广告质量之间差异。比如我们提交的竞价价格 <img src="http://latex.codecogs.com/gif.latex?%5Cinline%20%5Cdpi%7B150%7D%20%5Cwidehat%7Bc_i%7D" alt=""> 和实际支付的第二定价 <img src="http://latex.codecogs.com/gif.latex?%5Cinline%20%5Cdpi%7B150%7D%20%7Bc_i%7D" alt=""> , 我们可以构建一个竞价价格和定价价格之间的差值比例 <img src="http://latex.codecogs.com/gif.latex?%5Cinline%20%5Cdpi%7B150%7D%20%5Ctheta%20%3D%20%5Cfrac%7Bc_i%7D%7B%5Cwidehat%7Bc_i%7D%7D" alt="">, 那么在安全区我们提交的价格计算方式为： <img src="http://latex.codecogs.com/gif.latex?%5Cinline%20%5Cdpi%7B150%7D%20%5Cwidehat%7Bc_i%7D%20%3D%20%5Ctheta%20*%20%5Cmu_i" alt="">, 很显然通过这种方式在提高优化指标的同时也在影响消耗，但是由于在安全区所以问题不大</p>
<p>最后是危险区，对于处于危险区域的广告系列，有以下两个原因：</p>
<ul>
<li>由于受众定向条件太过严格，导致没有太多的竞价机会</li>
<li>竞价的价格太低导致胜率太低</li>
</ul>
<p>对于第一种情况没有办法解决，但是第二种情况可以通过调整价格的办法解决</p>
<p>比如设定的最大出价 <code>C</code> ，加价系数 <img src="http://latex.codecogs.com/gif.latex?%5Cinline%20%5Cdpi%7B150%7D%20%5Crho%5E*%20%5Cgeq%201" alt=""> ，通过将 加价系数和竞价率建立负相关关系来解决，计算方式如下：</p>
<p><img src="http://latex.codecogs.com/gif.latex?%5Cinline%20%5Cdpi%7B150%7D%20%5Crho%5E*%20%3D%201%20&plus;%20%5Cfrac%7B%5Cfrac%7BC%7D%7Bc%5E*%7D%20-%201%7D%7B1%20-%20%5Cbeta_2%7D%28pacing%5C_rate%28t%29%20-%20%5Cbeta_2%29" alt=""></p>
<p>通过将差价比例与 竞价率差价比例相乘来调整价格系数</p>
<p>最终通过 <img src="http://latex.codecogs.com/gif.latex?%5Cinline%20%5Cdpi%7B150%7D%20%5Cwidehat%7Bc_i%7D%20%3D%20%5Crho%5E*%5Cmu_i" alt=""> 来出价</p>
<h2 id="CTR-和-AR-预估"><a href="#CTR-和-AR-预估" class="headerlink" title="CTR 和 AR 预估"></a>CTR 和 AR 预估</h2><h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><ul>
<li><a href="https://www.zhihu.com/question/26419030" target="_blank" rel="external">置信区间</a></li>
<li><a href="https://www.zhihu.com/question/22913867" target="_blank" rel="external">中心极限定理</a></li>
<li><a href="https://dl.acm.org/citation.cfm?id=2501979" target="_blank" rel="external">Real Time Bid Optimization with Smooth Budget Delivery in Online Advertising</a></li>
</ul>

        
    

    
</div>


                

                <!-- Post Comments -->
                
                    
                
            </div>

            <!-- Post Prev & Next Nav -->
            <nav class="material-nav mdl-color-text--grey-50 mdl-cell mdl-cell--12-col">
    <!-- Prev Nav -->
    

    <!-- Section Spacer -->
    <div class="section-spacer"></div>

    <!-- Next Nav -->
    
        <a href="/2017/02/09/adbase/case/" id="post_nav-older" class="next-content">
            旧篇
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <button class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon mdl-color--white mdl-color-text--grey-900" role="presentation">
                <i class="material-icons">arrow_forward</i>
            </button>
        </a>
    
</nav>

        </div>
    </div>



                    
                        <!-- Overlay For Active Sidebar -->
<div class="sidebar-overlay"></div>

<!-- Material sidebar -->
<aside id="sidebar" class="sidebar sidebar-colored sidebar-fixed-left" role="navigation">
    <div id="sidebar-main">
        <!-- Sidebar Header -->
        <div class="sidebar-header header-cover" style="background-image: url(/img/sidebar_header.png);">
    <!-- Top bar -->
    <div class="top-bar"></div>

    <!-- Sidebar toggle button -->
    <button type="button" class="sidebar-toggle mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon" style="display: initial;" data-upgraded=",MaterialButton,MaterialRipple">
        <i class="material-icons">clear_all</i>
        <span class="mdl-button__ripple-container">
            <span class="mdl-ripple">
            </span>
        </span>
    </button>

    <!-- Sidebar Avatar -->
    <div class="sidebar-image">
        <img src="/img/avatar.jpg" alt="Nmred's avatar">
    </div>

    <!-- Sidebar Email -->
    <a data-toggle="dropdown" class="sidebar-brand" href="#settings-dropdown">
        nmred_2008@126.com
        <b class="caret"></b>
    </a>
</div>


        <!-- Sidebar Navigation  -->
        <ul class="nav sidebar-nav">
    <!-- User dropdown  -->
    <li class="dropdown">
        <ul id="settings-dropdown" class="dropdown-menu">
            
                <li>
                    <a href="#" target="_blank" title="Email Me">
                        
                            <i class="material-icons sidebar-material-icons sidebar-indent-left1pc-element">email</i>
                        
                        Email Me
                    </a>
                </li>
            
        </ul>
    </li>

    <!-- Homepage -->
    
        <li id="sidebar-first-li">
            <a href="/">
                
                    <i class="material-icons sidebar-material-icons">home</i>
                
                主页
            </a>
        </li>
        
    

    <!-- Archives  -->
    
        <li class="dropdown">
            <a href="#" class="ripple-effect dropdown-toggle" data-toggle="dropdown">
                
                    <i class="material-icons sidebar-material-icons">inbox</i>
                
                    归档
                <b class="caret"></b>
            </a>
            <ul class="dropdown-menu">
            <li>
                <a class="sidebar_archives-link" href="/archives/2017/02/">二月 2017<span class="sidebar_archives-count">3</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/01/">一月 2017<span class="sidebar_archives-count">19</span></a></li><li><a class="sidebar_archives-link" href="/archives/2015/06/">六月 2015<span class="sidebar_archives-count">14</span></a></li><li><a class="sidebar_archives-link" href="/archives/2015/05/">五月 2015<span class="sidebar_archives-count">5</span></a></li><li><a class="sidebar_archives-link" href="/archives/2015/04/">四月 2015<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2014/10/">十月 2014<span class="sidebar_archives-count">6</span></a></li><li><a class="sidebar_archives-link" href="/archives/2014/09/">九月 2014<span class="sidebar_archives-count">11</span></a></li><li><a class="sidebar_archives-link" href="/archives/2014/04/">四月 2014<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2014/03/">三月 2014<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/archives/2014/02/">二月 2014<span class="sidebar_archives-count">4</span></a></li><li><a class="sidebar_archives-link" href="/archives/2013/09/">九月 2013<span class="sidebar_archives-count">4</span></a></li><li><a class="sidebar_archives-link" href="/archives/2013/05/">五月 2013<span class="sidebar_archives-count">7</span></a></li><li><a class="sidebar_archives-link" href="/archives/2013/02/">二月 2013<span class="sidebar_archives-count">20</span></a>
            </ul>
        </li>
        
    

    <!-- Categories  -->
    
        <li class="dropdown">
            <a href="#" class="ripple-effect dropdown-toggle" data-toggle="dropdown">
                
                    <i class="material-icons sidebar-material-icons">chrome_reader_mode</i>
                
                分类
                <b class="caret"></b>
            </a>
            <ul class="dropdown-menu">
                <li>
                <a class="sidebar_archives-link" href="/categories/Adbase-文档/">Adbase 文档<span class="sidebar_archives-count">21</span></a></li><li><a class="sidebar_archives-link" href="/categories/C-语言/">C 语言<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/categories/GNU-M4-技术文档/">GNU M4 技术文档<span class="sidebar_archives-count">4</span></a></li><li><a class="sidebar_archives-link" href="/categories/Hadoop/">Hadoop<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/categories/SBT-快速入门/">SBT 快速入门<span class="sidebar_archives-count">14</span></a></li><li><a class="sidebar_archives-link" href="/categories/linux/">linux<span class="sidebar_archives-count">21</span></a></li><li><a class="sidebar_archives-link" href="/categories/php/">php<span class="sidebar_archives-count">5</span></a></li><li><a class="sidebar_archives-link" href="/categories/《C-Primer-Plus-第6版-》练习/">《C++ Primer Plus(第6版)》练习<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/categories/《unix-高级编程》-Note/">《unix 高级编程》-Note<span class="sidebar_archives-count">9</span></a></li><li><a class="sidebar_archives-link" href="/categories/《快学scala》练习/">《快学scala》练习<span class="sidebar_archives-count">16</span></a></li><li><a class="sidebar_archives-link" href="/categories/虚拟技术/">虚拟技术<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/categories/论文阅读/">论文阅读<span class="sidebar_archives-count">1</span></a>
            </ul>
        </li>
        
            <li class="divider"></li>
        
    

    <!-- Pages  -->
    
        <li>
            <a href="/timeline" title="时间轴">
                
                    <i class="material-icons sidebar-material-icons">timeline</i>
                
                时间轴
            </a>
        </li>
        
            <li class="divider"></li>
        
    

    <!-- Article Number  -->
    
        <li>
            <a href="/archives">
                文章总数
                <span class="sidebar-badge">97</span>
            </a>
        </li>
        
            <li class="divider"></li>
        
    
</ul>


        <!-- Sidebar Footer -->
        <!--
I'm glad you use this theme, the development is no so easy, I hope you can keep the copyright, I will thank you so much.
If you still want to delete the copyrights, could you still retain the first one? Which namely "Theme Material"
It will not impact the appearance and can give developers a lot of support :)

很高兴您使用并喜欢该主题，开发不易 十分谢谢与希望您可以保留一下版权声明。
如果您仍然想删除的话 能否只保留第一项呢？即 "Theme Material"
它不会影响美观并可以给开发者很大的支持和动力。 :)
-->

<!-- Sidebar Divider -->


<!-- Theme Material -->


<!-- Help & Support -->
<!--

-->

<!-- Feedback -->
<!--

-->

<!-- About Theme -->
<!--

-->

    </div>

    <!-- Sidebar Image -->
    

</aside>

                    

                    
                        <!-- Footer Top Button -->
                        <div id="back-to-top" class="toTop-wrap">
    <a href="#top" class="toTop">
        <i class="material-icons footer_top-i">expand_less</i>
    </a>
</div>

                    

                    <!--Footer-->
<footer class="mdl-mini-footer" id="bottom">
    
        <!-- Paradox Footer Left Section -->
        <div class="mdl-mini-footer--left-section sns-list">
    <!-- Twitter -->
    

    <!-- Facebook -->
    

    <!-- Google + -->
    

    <!-- Weibo -->
    
        <a href="https://weibo.com/nmred" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn footer-sns-weibo">
                <span class="visuallyhidden">Weibo</span>
            </button><!--
     --></a>
    

    <!-- Instagram -->
    

    <!-- Tumblr -->
    

    <!-- Github -->
    
        <a href="https://github.com/nmred" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn footer-sns-github">
                <span class="visuallyhidden">Github</span>
            </button><!--
     --></a>
    

    <!-- LinkedIn -->
    

    <!-- Zhihu -->
    

    <!-- Bilibili -->
    

    <!-- Telegram -->
    
    
    <!-- V2EX -->
    
</div>


        <!--Copyright-->
        <div id="copyright">
            Copyright&nbsp;©&nbsp;2013&nbsp;-<script type="text/javascript">var fd = new Date();document.write("&nbsp;" + fd.getFullYear() + "&nbsp;");</script>Iodsp
            
        </div>

        <!-- Paradox Footer Right Section -->

        <!--
        I am glad you use this theme, the development is no so easy, I hope you can keep the copyright.
        It will not impact the appearance and can give developers a lot of support :)

        很高兴您使用该主题，开发不易，希望您可以保留一下版权声明。
        它不会影响美观并可以给开发者很大的支持。 :)
        -->

        <div class="mdl-mini-footer--right-section">
            <div>
                <div class="footer-develop-div">Powered by <a href="https://hexo.io" target="_blank" class="footer-develop-a">Hexo</a></div>
                <div class="footer-develop-div">Theme - <a href="https://github.com/viosey/hexo-theme-material" target="_blank" class="footer-develop-a">Material</a></div>
            </div>
        </div>
    
</footer>


                    <!-- Import JS File -->

    <script>lsloader.load("lazyload_js","/js/lazyload.min.js?1BcfzuNXqV+ntF6gq+5X3Q==", true)</script>



    <script>lsloader.load("js_js","/js/js.min.js?V/53wGualMuiPM3xoetD5Q==", true)</script>



    <script>lsloader.load("np_js","/js/nprogress.js?pl3Qhb9lvqR1FlyLUna1Yw==", true)</script>


<script type="text/ls-javascript" id="NProgress-script">
    NProgress.configure({
        showSpinner: true
    });
    NProgress.start();
    $('#nprogress .bar').css({
        'background': '#29d'
    });
    $('#nprogress .peg').css({
        'box-shadow': '0 0 10px #29d, 0 0 15px #29d'
    });
    $('#nprogress .spinner-icon').css({
        'border-top-color': '#29d',
        'border-left-color': '#29d'
    });
    setTimeout(function() {
        NProgress.done();
        $('.fade').removeClass('out');
    }, 800);
</script>













<!-- UC Browser Compatible -->
<script>
	var agent = navigator.userAgent.toLowerCase();
	if(agent.indexOf('ucbrowser')>0) {
		document.write('<link rel="stylesheet" href="/css/uc.css">');
	   alert('由于 UC 浏览器使用极旧的内核，而本网站使用了一些新的特性。\n为了您能更好的浏览，推荐使用 Chrome 或 Firefox 浏览器。');
	}
</script>

<!-- Import prettify js  -->



<!-- Window Load -->
<!-- add class for prettify -->
<script type="text/ls-javascript" id="window-load">
    $(window).on('load', function() {
        // Post_Toc parent position fixed
        $('.post-toc-wrap').parent('.mdl-menu__container').css('position', 'fixed');
    });

    
    
</script>

<!-- MathJax Load-->


<!-- Bing Background -->


<script type="text/ls-javascript" id="lazy-load">
    // Offer LazyLoad
    queue.offer(function(){
        $('.lazy').lazyload({
            effect : 'show'
        });
    });

    // Start Queue
    $(document).ready(function(){
        setInterval(function(){
            queue.execNext();
        },200);
    });
</script>

<!-- Custom Footer -->



<script>
    (function(){
        var scriptList = document.querySelectorAll('script[type="text/ls-javascript"]')

        for (var i = 0; i < scriptList.length; ++i) {
            var item = scriptList[i];
            lsloader.runInlineScript(item.id,item.id);
        }
    })()
console.log('\n %c © Material Theme | Version: 1.5.0 | https://github.com/viosey/hexo-theme-material %c \n', 'color:#455a64;background:#e0e0e0;padding:5px 0;border-top-left-radius:5px;border-bottom-left-radius:5px;', 'color:#455a64;background:#e0e0e0;padding:5px 0;border-top-right-radius:5px;border-bottom-right-radius:5px;');
</script>

                </main>
            </div>
        </body>
    
</html>
